<s:fragment
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:rich="http://richfaces.org/rich">

  <script>
    function onProjectTypeChanged(radioForm) {
      var id = jQuery(radioForm).children(".form__radio__input").attr("id");
      var selectedProjectType = id.substring('project-type-'.length, id.length);
      bindProjectTypeValue(selectedProjectType);
    }

  </script>
  <a4j:jsFunction name="bindProjectTypeValue" limitRender="true">
    <a4j:param name="val" assignTo="#{projectHome.selectedProjectType}"/>
  </a4j:jsFunction>


  <div class="g--tight l--push-top-1">
    <div class="g__item w--1-2">
      <div class="form__item">
        <h:outputLabel for="name">#{messages['jsf.ProjectName']}</h:outputLabel>
        <s:decorate id="nameField" template="../field.xhtml" enclose="true">
          <h:inputText id="name" required="true" maxlength="80"
            value="#{projectHome.instance.name}">
            <a4j:ajax event="blur" render="nameField" execute="@this"/>
          </h:inputText>
        </s:decorate>
      </div>
    </div>
    <div class="g__item w--1-2">
      <div class="form__item">
        <h:outputLabel for="slug">#{messages['jsf.ProjectId']}</h:outputLabel>
        <s:decorate id="slugField" template="../field.xhtml" enclose="true">
          <h:inputText rendered="#{projectHome.managed}" disabled="true"
            value="#{projectHome.instance.slug}">
          </h:inputText>

          <h:inputText rendered="#{not projectHome.managed}" maxlength="40"
            id="slug" required="true"
            value="#{projectHome.instance.slug}"
            valueChangeListener="#{projectHome.verifySlugAvailable}">
            <a4j:ajax event="blur" render="slugField" execute="@this"/>
            <f:validateLength minimum="1"/>
          </h:inputText>
        </s:decorate>
      </div>
    </div>
  </div>

  <div class="form__item l--push-bottom-1">
    <h:outputLabel for="descriptionField">#{messages['jsf.ProjectDescription']}
      <span class="txt--meta">#{messages['jsf.field.optional']}</span>
    </h:outputLabel>
    <s:decorate id="descriptionField" template="../field.xhtml">
      <h:inputTextarea id="description" required="false"
        value="#{projectHome.instance.description}">
        <f:validateLength maximum="100"/>
        <a4j:ajax event="blur" render="descriptionField" execute="@this"/>
      </h:inputTextarea>
    </s:decorate>
  </div>

  <h3
    class="heading--secondary l--push-all-0">#{messages['jsf.ProjectType']}</h3>

  <p>#{messages['jsf.ProjectType.title']}
    <a href="http://zanata.org/help/projects/create-project/"
      title="#{messages['jsf.projectType.Description']}">
      <i class="i i--help"></i>
    </a>
  </p>
  <ul class="list--slat l--push-bottom-1">
    <li>
      <div class="form__radio js-form__radio"
        onclick="onProjectTypeChanged(this)">
        <s:fragment
          rendered="#{projectHome.instance.defaultProjectType eq null}">
          <input type="radio" name="project-type" id="project-type-null"
            checked="true" class="form__radio__input js-form__radio__input"/>
        </s:fragment>
        <s:fragment
          rendered="#{projectHome.instance.defaultProjectType ne null}">
          <input type="radio" name="project-type" id="project-type-null"
            class="form__radio__input js-form__radio__input"/>
        </s:fragment>
        <label for="project-type-null"
          class="form__radio__label">#{messages['jsf.projectType.NoSelection']}
        </label>
      </div>
    </li>

    <ui:repeat value="#{projectHome.projectTypeList}" var="projectType">
      <li>
        <div class="form__radio js-form__radio"
          onclick="onProjectTypeChanged(this)">
          <s:fragment
            rendered="#{projectHome.instance.defaultProjectType.name() eq projectType.name()}">
            <input type="radio" name="project-type"
              class="form__radio__input js-form__radio__input"
              id="project-type-#{projectType.name()}" checked="true"/>
          </s:fragment>
          <s:fragment
            rendered="#{projectHome.instance.defaultProjectType.name() ne projectType.name()}">
            <input type="radio" name="project-type"
              class="form__radio__input js-form__radio__input"
              id="project-type-#{projectType.name()}"/>
          </s:fragment>
          <label for="project-type-#{projectType.name()}"
            class="form__radio__label">#{projectType.name()} <span
            class="txt--meta">#{messages['jsf.projectType.detail.'.concat(projectType)]}</span>
          </label>
        </div>
      </li>
    </ui:repeat>
  </ul>


  <h3 class="heading--secondary">#{messages['jsf.project.SourceCode']}</h3>

  <div class="g--tight l--push-top-half">
    <div class="g__item w--1-2">
      <div class="form__item">
        <h:outputLabel for="homePage">#{messages['jsf.project.HomePage']}
          <span class="txt--meta">#{messages['jsf.field.optional']}</span>
        </h:outputLabel>
        <s:decorate id="homePageField" template="../field.xhtml">
          <h:inputText id="homePage" required="false"
            value="#{projectHome.instance.sourceViewURL}">
            <rich:placeholder value="http://" styleClass="txt--neutral"/>
            <a4j:ajax event="blur" render="homePageField" execute="@this"/>
          </h:inputText>
        </s:decorate>

        <p class="txt--meta">#{messages['jsf.Project.sourceurl.message']}</p>
      </div>
    </div>
    <div class="g__item w--1-2">
      <div class="form__item">
        <h:outputLabel for="repo">#{messages['jsf.field.repository']}
          <span class="txt--meta">#{messages['jsf.field.optional']}</span>
        </h:outputLabel>
        <s:decorate id="repoField" template="../field.xhtml">
          <h:inputText id="repo" required="false"
            value="#{projectHome.instance.sourceCheckoutURL}">
            <rich:placeholder value="git@github.com:zanata/zanata-server.git"
              styleClass="txt--neutral"/>
            <a4j:ajax event="blur" render="repoField" execute="@this"/>
          </h:inputText>
        </s:decorate>

        <p class="txt--meta">#{messages['jsf.Project.repo.message']}</p>
      </div>
    </div>
  </div>
</s:fragment>